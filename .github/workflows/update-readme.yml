name: ğŸ§  Update GitHub Metrics

on:
  schedule:
    - cron: "0 9 * * 1"   # lunes 09:00 UTC (puedes cambiarlo si quieres diario)
  workflow_dispatch:

jobs:
  metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write   # necesario para escribir el archivo en el repo

    steps:
      - name: Generate metrics
        uses: lowlighter/metrics@latest
        with:
          # --- ğŸ” AutenticaciÃ³n ---
          token: ${{ secrets.METRICS_TOKEN }}             # para leer tus datos
          committer_token: ${{ secrets.METRICS_TOKEN }}   # usa tu PAT para hacer el commit
          committer_branch: main                          # rama destino

          # --- âš™ï¸ ConfiguraciÃ³n general ---
          user: xavki
          template: classic
          base: header, activity, community, repositories, metadata
          config_timezone: Europe/Madrid

          # --- ğŸ§© Plugins activados ---
          plugin_languages: yes
          plugin_achievements: yes
          plugin_repositories: yes

          # --- ğŸ“¦ ConfiguraciÃ³n de repositorios automÃ¡ticos ---
          plugin_repositories_featured: 2           # 0 = repos seleccionados automÃ¡ticamente
          plugin_repositories_starred: yes          # muestra tambiÃ©n los mÃ¡s "starred"
          plugin_repositories_affiliations: owner   # solo tus propios repos (no forks)

          # --- ğŸ’¾ Salida ---
          filename: github-metrics.svg
          output_action: commit                     # escribe directamente el archivo
